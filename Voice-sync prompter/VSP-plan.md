# Voice-Sync Prompter (VSP) 프로젝트 계획서

> 음성 인식 기반 자동 스크롤 프롬프터 애플리케이션

## 프로젝트 개요

영상 촬영 시 사용하는 프롬프터 프로그램으로, 마이크를 통해 들어오는 음성을 실시간으로 인식하여 대본과 비교하면서 자동으로 스크롤되는 것이 핵심 기능입니다.

---

## 1. 기술 스택

### 프론트엔드
| 기술 | 선택 | 이유 |
|------|------|------|
| 프레임워크 | **Electron** | 풍부한 생태계, 크로스 플랫폼, 시스템 리소스 접근 용이 |
| UI 라이브러리 | **React** | 반응형 UI 구현, 컴포넌트 기반 개발 |
| 언어 | **TypeScript** | 타입 안정성, 개발 생산성 |
| 스타일링 | **Tailwind CSS + shadcn/ui** | 빠른 UI 구축, 다크모드 지원 |
| 상태관리 | **Zustand** | 경량, 간단한 API |

### 음성 인식 엔진
| 단계 | 엔진 | 특징 |
|------|------|------|
| MVP | **Web Speech API** | 무료, 브라우저 내장, 빠른 프로토타이핑 |
| 고도화 | **Whisper (OpenAI)** | 높은 정확도, 로컬 실행, 오프라인 지원, 한국어 우수 |

### 아키텍처 다이어그램
```
┌─────────────────────────────────────────────────────┐
│                   Electron App                      │
├─────────────────────────────────────────────────────┤
│  ┌─────────────┐    ┌─────────────┐    ┌─────────┐ │
│  │   React UI  │◄───│   Zustand   │◄───│   IPC   │ │
│  │  (프롬프터)  │    │   Store     │    │ Bridge  │ │
│  └─────────────┘    └─────────────┘    └────┬────┘ │
├─────────────────────────────────────────────┼──────┤
│  Main Process                               │      │
│  ┌─────────────┐    ┌─────────────┐    ┌───┴────┐ │
│  │    STT      │───►│  Text Match │───►│ Scroll │ │
│  │   Engine    │    │   Engine    │    │ Control│ │
│  └──────┬──────┘    └─────────────┘    └────────┘ │
│         │                                          │
│  ┌──────┴──────┐                                   │
│  │ Audio Input │                                   │
│  └─────────────┘                                   │
└─────────────────────────────────────────────────────┘
```

---

## 2. 핵심 알고리즘

### 텍스트 매칭 전략

#### Fuzzy Matching + Sliding Window
```
1. 음성 인식 → 텍스트 변환
2. 현재 위치 기준 ±50~100단어 범위에서 검색 (Window)
3. Levenshtein Distance로 유사도 계산
4. 신뢰도 > 임계값 → 부드러운 스크롤 이동
5. 신뢰도 < 임계값 → 스크롤 일시 정지
```

#### 핵심 인터페이스
```typescript
interface MatchResult {
  position: number;      // 대본 내 현재 위치 (문자 인덱스)
  confidence: number;    // 매칭 신뢰도 (0-1)
  matchedText: string;   // 매칭된 대본 부분
}

interface ScrollState {
  currentPosition: number;
  targetPosition: number;
  isAutoScrolling: boolean;
  speed: number;
}
```

#### 매칭 최적화 기법
- **N-gram 매칭**: 연속 3-4단어 시퀀스로 정확도 향상
- **음절 단위 비교**: 한국어 특성에 최적화
- **중간 결과 활용**: `interimResults`로 지연 최소화
- **컨텍스트 가중치**: 이전 위치 기반으로 갑작스러운 점프 방지

#### 전처리 파이프라인
```
원본 텍스트
    ↓
숫자 → 한글 변환 ("123" → "백이십삼")
    ↓
특수문자 제거
    ↓
공백 정규화
    ↓
매칭용 텍스트
```

---

## 3. UI/UX 설계

### 화면 레이아웃
```
┌────────────────────────────────────────────────────┐
│ [설정] [대본 불러오기] [마이크 선택]        [녹화 모드] │
├────────────────────────────────────────────────────┤
│                                                    │
│                                                    │
│          지금 읽고 있는 문장이 여기에               │
│          크게 표시됩니다                            │
│                                                    │ ← 현재 위치
│   ─────────────────────────────────────────────   │
│                                                    │
│          다음에 읽을 내용이 여기에                  │
│          미리 보입니다                              │
│                                                    │
│                                                    │
├────────────────────────────────────────────────────┤
│ 인식: "지금 읽고 있는 문장이..."  [신뢰도: 92%]     │
└────────────────────────────────────────────────────┘
```

### 필수 기능
| 기능 | 설명 | 우선순위 |
|------|------|----------|
| 고대비 모드 | 검정 배경 + 흰색/노란색 텍스트 | P0 |
| 폰트 크기 조절 | 촬영 거리에 따른 실시간 조절 | P0 |
| 줄 간격 조절 | 가독성 향상 | P0 |
| 현재 위치 하이라이트 | 읽는 부분 강조 표시 | P0 |
| 부드러운 스크롤 | ease-in-out 애니메이션 | P0 |
| 수동 오버라이드 | 키보드/마우스로 즉시 개입 | P0 |
| 미러링 모드 | 전문 프롬프터용 좌우반전 | P1 |
| 전체화면 모드 | 불필요한 UI 숨김 | P1 |
| 외부 디스플레이 | 연기자용/촬영자용 분리 | P2 |

### 키보드 단축키
| 단축키 | 기능 |
|--------|------|
| `Space` | 자동 스크롤 시작/정지 |
| `↑` / `↓` | 수동 스크롤 |
| `Home` | 처음으로 이동 |
| `End` | 끝으로 이동 |
| `+` / `-` | 폰트 크기 조절 |
| `M` | 미러링 토글 |
| `F` / `F11` | 전체화면 토글 |
| `Esc` | 전체화면 해제 |

---

## 4. 기술적 도전과 해결책

### 도전 1: 음성 인식 지연 (Latency)
**문제**: 실시간 인식이 0.5-2초 지연될 수 있음

**해결책**:
- 중간 결과(`interimResults`) 적극 활용
- 예측 스크롤: 말하는 속도 분석 후 선제적 이동
- 짧은 오디오 청크(100-200ms) 단위 스트리밍 처리

### 도전 2: 배경 소음
**문제**: 촬영 현장의 다양한 소음

**해결책**:
- 노이즈 게이트 적용 (일정 볼륨 이하 무시)
- VAD (Voice Activity Detection) 적용
- RNNoise 라이브러리 통합 검토
- 지향성 마이크 사용 권장

### 도전 3: 대본 이탈 / 애드립
**문제**: 발화자가 대본과 다르게 말할 때

**해결책**:
```
[전략 1: 유사 구문 건너뛰기]
대본: "A → B → C → D"
발화: "A → D" (B, C 건너뜀)
→ D 위치로 자동 점프

[전략 2: 대기 모드]
신뢰도 < 50%가 3초 이상 지속
→ 스크롤 일시 정지 + 시각적 표시
→ 다시 매칭되면 재개
```

### 도전 4: 동음이의어 / 유사 발음
**문제**: "개발"과 "계발", "기사"와 "기자" 등

**해결책**:
- 문맥 기반 가중치 부여
- 이전/이후 단어 함께 비교 (N-gram)
- 사용자 사전 등록 기능

### 도전 5: 긴 대본 성능
**문제**: 대본이 길어지면 매칭 성능 저하

**해결책**:
- 검색 윈도우 제한: 현재 위치 ±500자만 검색
- 대본 청크 분할 및 사전 인덱싱
- Web Worker에서 매칭 처리 (UI 블로킹 방지)

---

## 5. 개발 로드맵

### Phase 1: MVP (핵심 기능)
- [ ] 프로젝트 초기 세팅 (Electron + React + TypeScript)
- [ ] 대본 입력/편집 UI
- [ ] Web Speech API 음성 인식 연동
- [ ] 기본 텍스트 매칭 (단순 문자열 비교)
- [ ] 수동 스크롤 기능
- [ ] 자동 스크롤 기능 (기본)
- [ ] 고대비 모드 UI

### Phase 2: 고도화
- [ ] Whisper 로컬 통합 (오프라인 지원)
- [ ] Fuzzy Matching 알고리즘 구현
- [ ] 미러링 모드
- [ ] 전체화면 모드
- [ ] 프리셋 저장/불러오기
- [ ] 외부 디스플레이 지원

### Phase 3: 프로덕션
- [ ] 성능 최적화
- [ ] 다국어 지원
- [ ] 리모컨/페달 입력 지원
- [ ] 클라우드 동기화 (선택)
- [ ] 자동 업데이트

---

## 6. 프로젝트 구조 (예정)

```
Voice-sync prompter/
├── VSP-plan.md              # 이 문서
├── package.json
├── electron/
│   ├── main.ts              # Electron 메인 프로세스
│   ├── preload.ts           # IPC 브릿지
│   └── audio/
│       └── stt-engine.ts    # 음성 인식 엔진
├── src/
│   ├── App.tsx
│   ├── components/
│   │   ├── Prompter/        # 프롬프터 메인 뷰
│   │   ├── Editor/          # 대본 편집기
│   │   ├── Settings/        # 설정 패널
│   │   └── Controls/        # 컨트롤 버튼
│   ├── hooks/
│   │   ├── useSpeechRecognition.ts
│   │   ├── useTextMatcher.ts
│   │   └── useAutoScroll.ts
│   ├── store/
│   │   └── index.ts         # Zustand 스토어
│   ├── utils/
│   │   ├── textMatcher.ts   # 텍스트 매칭 알고리즘
│   │   └── textNormalizer.ts
│   └── styles/
│       └── globals.css
└── tests/
    └── textMatcher.test.ts
```

---

## 7. 참고 자료

- [Electron 공식 문서](https://www.electronjs.org/docs)
- [Web Speech API MDN](https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API)
- [OpenAI Whisper](https://github.com/openai/whisper)
- [Levenshtein Distance 알고리즘](https://en.wikipedia.org/wiki/Levenshtein_distance)
- [shadcn/ui](https://ui.shadcn.com/)

---

## 변경 이력

| 날짜 | 버전 | 내용 |
|------|------|------|
| 2026-01-17 | 0.1 | 초기 계획서 작성 (Council 결과 기반) |
